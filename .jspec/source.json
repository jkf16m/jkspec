{
  "project": {
    "name": "jspec",
    "description": "JSON-based specification format for rapid AI agent context retrieval. Provides jspec-template as a starter template for projects.",
    "version": "0.1.0",
    "architecture": {
      "style": "single-file specification",
      "pattern": "spec-driven development",
      "philosophy": "Provide AI agents with structured, queryable context to eliminate codebase exploration overhead"
    },
    "conventions": {
      "spec_location": ".jspec/source.json",
      "query_tool": "jq",
      "spec_keys": "Use kebab-case for spec identifiers (e.g., 'auth-service', 'user-model')",
      "versioning": "Semantic versioning for the spec format itself"
    },
    "decisions": [
      {
        "id": "ADR-001",
        "title": "Use single JSON file as source of truth",
        "status": "accepted",
        "date": "2025-12-25",
        "context": "AI agents waste time exploring codebases. Need fast, precise context retrieval.",
        "decision": "Use single .jspec/source.json file with structured data, queryable via jq",
        "consequences": "Agents get instant context. Must maintain spec alongside code. JSON parsing overhead minimal."
      },
      {
        "id": "ADR-002",
        "title": "Use object for specs instead of array",
        "status": "accepted",
        "date": "2025-12-25",
        "context": "Need to avoid duplicate keys and enable direct access",
        "decision": "Use object with unique keys for specs: {\"spec-name\": {...}}",
        "consequences": "Direct access via jq '.specs[\"name\"]'. Natural key uniqueness. Slightly more verbose queries for filtering."
      }
    ]
  },
  "specs": {
    "jspec-format": {
      "type": "specification",
      "description": "The jspec format itself - structure and conventions",
      "status": "draft",
      "tags": [
        "meta",
        "format"
      ],
      "structure": {
        "project": {
          "name": "string - project name",
          "description": "string - brief project description",
          "version": "string - semver",
          "architecture": "object - architectural overview",
          "conventions": "object - global coding and organizational conventions",
          "decisions": "array - architectural decision records"
        },
        "specs": {
          "description": "object - keyed by unique spec identifier",
          "spec_schema": {
            "type": "string - spec type (api, model, component, etc.)",
            "description": "string - what this spec describes",
            "status": "string - draft, active, deprecated",
            "tags": "array - searchable tags",
            "...": "any additional fields relevant to the spec"
          }
        }
      },
      "examples": {
        "get_project_info": "jq '.project' .jspec/source.json",
        "list_all_specs": "jq '.specs | keys' .jspec/source.json",
        "get_specific_spec": "jq '.specs[\"spec-name\"]' .jspec/source.json",
        "filter_by_type": "jq '.specs | to_entries[] | select(.value.type==\"api\")' .jspec/source.json",
        "filter_by_tag": "jq '.specs | to_entries[] | select(.value.tags[]? == \"authentication\")' .jspec/source.json"
      },
      "location": ".jspec/source.json"
    },
    "jspec-cli": {
      "type": "tool",
      "description": "Bash CLI tool for managing .jspec/source.json files",
      "status": "active",
      "tags": [
        "cli",
        "tooling",
        "bash"
      ],
      "location": ".jspec/cli/jspec.sh",
      "dependencies": [
        "jq"
      ],
      "commands": {
        "init": "Initialize a new jspec project",
        "add-spec": "Add a new spec with ID, type, description, and tags",
        "update-spec": "Update a field in an existing spec",
        "remove-spec": "Remove a spec by ID",
        "list": "List all spec IDs",
        "get": "Get a specific spec by ID",
        "help": "Show usage information"
      },
      "purpose": "Provide a human-friendly CLI interface for creating and managing jspec files without manual JSON editing"
    },
    "jspec-depth-system": {
      "type": "feature",
      "description": "Single unified agent architecture where jspec-worker handles all operations from high-level management to detailed implementation",
      "status": "active",
      "tags": [
        "architecture",
        "unified-agent"
      ],
      "purpose": "Simplified architecture with one agent that can handle any jspec task",
      "concepts": {
        "spec_levels": {
          "simple": "Single file, small component, or focused investigation",
          "medium": "Module, service, or feature with multiple files",
          "complex": "System, architecture, or large-scale feature spanning multiple modules"
        },
        "unified_approach": "Single agent handles both management operations (add/update/validate specs) and implementation work (read/implement/verify specs)"
      },
      "agent_responsibilities": {
        "jspec-worker": "Handles ALL operations: extends specs, validates structure, analyzes codebase, implements features, explains specs, and verifies implementations"
      },
      "location": ".opencode/agent/",
      "implemented_in": [
        ".opencode/agent/jspec-worker.md"
      ]
    },
    "jspec-worker": {
      "type": "agent",
      "description": "Unified agent for managing and implementing jspec specifications - handles both high-level management operations and detailed implementation work",
      "status": "active",
      "tags": [
        "ai-agents",
        "management",
        "implementation"
      ],
      "purpose": "Single agent that can extend, validate, maintain jspec files AND read/implement individual specs",
      "capabilities": {
        "management": [
          "Add new specs (extend command)",
          "Update existing specs (update command)",
          "Validate jspec structure (validate command)",
          "Analyze specs and provide recommendations (analyze command)",
          "Suggest missing specs (suggest-specs command)",
          "Sync specs with codebase (sync command)",
          "Verify implementation status (test-sync command)"
        ],
        "implementation": [
          "Read and explain spec details (explain command)",
          "Implement specs according to requirements (implement command)",
          "Verify implementations match specs (verify command)",
          "Work with complex multi-component specs"
        ]
      },
      "commands": {
        "extend": "Add a new spec to the jspec file",
        "update": "Update an existing spec field",
        "validate": "Validate the jspec structure and check for inconsistencies",
        "analyze": "Analyze the current jspec structure and provide recommendations",
        "suggest-specs": "Suggest missing specs based on codebase analysis",
        "sync": "Ensure jspec is in sync with actual codebase structure",
        "test-sync": "Verify that all specs have corresponding implementations",
        "implement": "Implement a spec according to its requirements",
        "explain": "Read and explain a specific spec's details",
        "verify": "Verify if a spec is implemented correctly"
      },
      "location": ".opencode/agent/jspec-worker.md",
      "dependencies": [
        "jspec-cli"
      ],
      "tool_resolution": "dynamic",
      "reading_policy": "MANDATORY: Always use jspec-cli tool for reading specs. Use '.jspec/cli/jspec.sh get <spec-id>' instead of jq queries. This ensures consistent access patterns and proper tool usage."
    },
    "jspec-internal-tests": {
      "type": "experiment",
      "description": "Folder containing small test programs to validate jspec capabilities and workflows",
      "status": "draft",
      "tags": [
        "testing",
        "meta",
        "internal"
      ],
      "purpose": "Sandbox for experimenting with jspec workflows, agent capabilities, and spec-driven development",
      "tests": {
        "tictactoe-cli": {
          "type": "cli-game",
          "description": "Simple command-line tic-tac-toe game implementation",
          "status": "draft",
          "requirements": [
            "Two-player game (human vs human)",
            "Command-line interface",
            "Display game board after each move",
            "Input validation for moves",
            "Win/draw detection",
            "Game restart option"
          ],
          "tech_stack": "bash or python (to be determined)",
          "location": ".jspec/tests/tictactoe/"
        }
      }
    },
    "jspec-template": {
      "type": "template",
      "description": "Starter template for new jspec projects",
      "status": "draft",
      "tags": [
        "template",
        "setup"
      ],
      "location": "jspec-template/"
    }
  },
  "worker": {
    "bootstrap": {
      "first_command": "jq '.worker' .jspec/source.json",
      "description": "On initialization, agent must read the worker object which contains all operational definitions",
      "cli_fetch": "JSPEC_CLI=$(jq -r '.specs[\"jspec-cli\"].location' .jspec/source.json)"
    },
    "commands_location": ".opencode/commands",
    "commands_description": "All jspec-worker commands are defined as individual markdown files in .opencode/commands/ directory. Each command file contains description, steps, and additional context.",
    "available_commands": [
      "jspec-extend",
      "jspec-update", 
      "jspec-validate",
      "jspec-analyze",
      "jspec-suggest-specs",
      "jspec-sync",
      "jspec-test-sync",
      "jspec-implement",
      "jspec-explain",
      "jspec-verify"
    ],
    "reading_policy": {
      "cli_mandatory": true,
      "bootstrap_exceptions": [
        "Fetching CLI location from specs",
        "Reading worker object itself",
        "Reading project metadata"
      ],
      "allowed_direct_queries": [
        "jq -r '.specs[\"jspec-cli\"].location' .jspec/source.json",
        "jq '.worker' .jspec/source.json",
        "jq '.project' .jspec/source.json"
      ],
      "mandatory_cli_usage": [
        "$JSPEC_CLI get <spec-id> - for reading any spec",
        "$JSPEC_CLI list - for listing all spec IDs",
        "$JSPEC_CLI add-spec - for adding specs",
        "$JSPEC_CLI update-spec - for updating specs",
        "$JSPEC_CLI remove-spec - for removing specs"
      ],
      "rationale": "Ensures consistent access patterns, proper tool usage validation, and single source of truth for spec retrieval"
    },
    "guidelines": [
      "Always validate input - check spec-id naming conventions and required fields",
      "Fetch tool locations dynamically from source.json",
      "Use jspec CLI for all spec modifications",
      "Use CLI for reading specs (except bootstrap cases)",
      "Be concise and provide clear, actionable output",
      "Show results after operations",
      "Handle errors gracefully with explanations",
      "Follow kebab-case convention for spec IDs",
      "Be autonomous within spec scope",
      "Ensure thorough implementation according to requirements"
    ],
    "complex_specs": {
      "description": "How to handle specs with multiple components",
      "approach": [
        "Identify child specs (look for children, specs, tests fields)",
        "Break down work into components",
        "Implement systematically through each component",
        "Track progress and update status fields",
        "Report comprehensively on all components"
      ]
    }
  }
}
